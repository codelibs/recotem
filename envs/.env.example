# ============================================
# Database (PostgreSQL)
# ============================================
POSTGRES_USER=recotem_user
POSTGRES_PASSWORD=CHANGE_ME_to_a_secure_password
POSTGRES_DB=recotem
PGDATA=/var/lib/postgresql/data/pgdata
DATABASE_URL=postgresql://recotem_user:CHANGE_ME_to_a_secure_password@db:5432/recotem

# ============================================
# Security
# ============================================
# Generate a strong secret key with:
#   python -c 'from django.core.management.utils import get_random_secret_key; print(get_random_secret_key())'
SECRET_KEY=CHANGE_ME_to_a_random_secret_key
DEBUG=false
ALLOWED_HOSTS=localhost,127.0.0.1
DEFAULT_ADMIN_PASSWORD=very_bad_password
# HTTPS settings â€” enable these when serving behind HTTPS:
# SECURE_SSL_REDIRECT=true
# SESSION_COOKIE_SECURE=true
# CSRF_COOKIE_SECURE=true
# SECURE_HSTS_SECONDS=31536000

# ============================================
# Redis
# ============================================
REDIS_PASSWORD=
CELERY_BROKER_URL=redis://redis:6379/0
# Django Channels WebSocket layer (db 1)
CHANNELS_REDIS_URL=redis://redis:6379/1
CACHE_REDIS_URL=redis://redis:6379/2
CACHE_KEY_PREFIX=recotem

# ============================================
# Auth
# ============================================
# JWT access token lifetime in seconds (default 300 = 5 minutes)
# ACCESS_TOKEN_LIFETIME=300

# ============================================
# Rate Limiting
# ============================================
THROTTLE_ANON_RATE=20/min
THROTTLE_USER_RATE=100/min
THROTTLE_LOGIN_RATE=5/min
THROTTLE_RECOMMENDATION_RATE=30/min

# ============================================
# CORS/CSRF (for split frontend/backend deployments)
# ============================================
# CORS_ALLOWED_ORIGINS=https://app.example.com
# CSRF_TRUSTED_ORIGINS=https://app.example.com

# ============================================
# Logging
# ============================================
# LOG_LEVEL=INFO
# DJANGO_LOG_LEVEL=WARNING
# CELERY_LOG_LEVEL=INFO

# ============================================
# Worker Limits
# ============================================
CELERY_TASK_TIME_LIMIT=3600
CELERY_TASK_SOFT_TIME_LIMIT=3480
# How long to keep Celery task results in the database (seconds, default 7 days)
# CELERY_RESULT_EXPIRES=604800

# ============================================
# Database Connection Pooling
# ============================================
# Keep database connections open for N seconds (default 600 for ASGI efficiency)
# Set to 0 to close after each request
# CONN_MAX_AGE=600

# ============================================
# Upload / Cache Limits
# ============================================
# Max upload size in bytes (default 500MB, must match nginx client_max_body_size)
# DATA_UPLOAD_MAX_MEMORY_SIZE=524288000
# Number of trained models kept in memory cache (default 8)
# MODEL_CACHE_SIZE=8

# ============================================
# Storage (optional S3)
# ============================================
# To use S3-compatible object storage for trained model files:
#   1. Set RECOTEM_STORAGE_TYPE=S3
#   2. Provide AWS credentials (or use IAM roles on EKS/ECS)
#   3. Create the bucket before starting the application
# RECOTEM_STORAGE_TYPE=S3
# AWS_ACCESS_KEY_ID=
# AWS_SECRET_ACCESS_KEY=
# AWS_STORAGE_BUCKET_NAME=recotem-models
# AWS_S3_ENDPOINT_URL=              # Leave empty for AWS; set for MinIO/R2

# ============================================
# Frontend (when served separately)
# ============================================
# VITE_API_BASE_URL=https://api.example.com/api/v1
# VITE_WS_BASE_URL=wss://api.example.com/ws
